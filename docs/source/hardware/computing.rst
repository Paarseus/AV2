=========
Computing
=========

Main Computer
=============

Runs perception, planning, and control software.

+-------------------+---------------------------+
| OS                | Ubuntu 22.04 LTS          |
+-------------------+---------------------------+
| GPU               | NVIDIA GTX 1060+ (6GB+)   |
+-------------------+---------------------------+
| RAM               | 16+ GB                    |
+-------------------+---------------------------+
| Storage           | 256+ GB SSD               |
+-------------------+---------------------------+

Distributed CAN Control
=======================

4 Teensy 4.1 microcontrollers communicate over 250 kbps CAN bus:

.. code-block:: text

   Main Computer
        │ USB Serial (115200 baud)
        ▼
   ┌─────────────┐
   │ CAN Master  │ Teensy 4.1 + Waveshare CAN
   └──────┬──────┘
          │ CAN Bus (250 kbps)
   ═══════╪═══════════════════════════
          │           │           │
   ┌──────┴──────┐ ┌──┴───┐ ┌────┴────┐
   │  Steering   │ │Throttle│ │  Brake  │
   │  (0x200)    │ │(0x100) │ │ (0x300) │
   └─────────────┘ └────────┘ └─────────┘

CAN Message IDs
---------------

+------------+-------------+-------------+
| Node       | Command ID  | Status ID   |
+============+=============+=============+
| Throttle   | 0x100       | 0x101       |
+------------+-------------+-------------+
| Steering   | 0x200       | 0x201       |
+------------+-------------+-------------+
| Brake      | 0x300       | 0x301       |
+------------+-------------+-------------+

Serial Commands (to CAN Master)
-------------------------------

.. code-block:: text

   T 0.5      # Throttle 50%
   S -0.25    # Steer 25% left
   B 1.0      # Full brake
   M D        # Drive mode (N/D/S/R)
   E 1        # E-Stop engage

Teensy 4.1 Specs
----------------

+-------------------+---------------------------+
| Processor         | ARM Cortex-M7 @ 600 MHz   |
+-------------------+---------------------------+
| CAN Controllers   | 3× FlexCAN (CAN 2.0B)     |
+-------------------+---------------------------+
| CAN Pins          | TX=22, RX=23              |
+-------------------+---------------------------+

Waveshare CAN Transceiver
-------------------------

+-------------------+---------------------------+
| Chip              | SN65HVD230 / MCP2551      |
+-------------------+---------------------------+
| Max Data Rate     | 1 Mbps                    |
+-------------------+---------------------------+
